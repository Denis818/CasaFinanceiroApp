<div options>
  <input type="text" name="firstname" placeholder="Buscar por item..." />

  <button botao-add>
    <div icon-bg>
      <img
        class="icon-position"
        src="../../../../../assets/icons/nova-categoria.svg"
        alt="Ícone de nova-categoria"
      />
    </div>

    <span options-title>Nova Categoria</span>
  </button>

  <button botao-add (click)="openModalInsertDespesa()">
    <div icon-bg>
      <img
        class="icon-position"
        src="../../../../../assets/icons/nova-compra.svg"
        alt="Ícone de nova compra"
      />
    </div>

    <span options-title>Nova Despesa</span>
  </button>

  <button botao-add>
    <div icon-bg>
      <img
        class="icon-position membro-position"
        src="../../../../../assets/icons/novo-membro.svg"
        alt="Ícone de nova-categoria"
      />
    </div>

    <span options-title>Novo Membro</span>
  </button>
</div>

<!-- Tabela de Despesas -->
<table class="table-editable">
  <thead>
    <tr>
      <th>Id</th>
      <th>Item</th>
      <th>Categoria</th>
      <th>Fornecedor</th>
      <th>Preço</th>
      <th>Quantidade</th>
      <th>Total</th>
      <th>Data da compra</th>
      <th>Opções</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let despesa of despesas">
      <td>{{ despesa.id }}</td>
      <td>
        <div *ngIf="despesa.isEditing; else viewItem">
          <input
            type="text"
            [(ngModel)]="despesa.item"
            (blur)="updateDespesa(despesa.id, despesa)"
            (keyup.enter)="updateDespesa(despesa.id, despesa)"
          />
        </div>
        <ng-template #viewItem>{{ despesa.item }}</ng-template>
      </td>
      <td>
        <div *ngIf="despesa.isEditing; else viewCategoria">
          <input
            type="text"
            [(ngModel)]="despesa.categoria.descricao"
            (blur)="updateDespesa(despesa.id, despesa)"
            (keyup.enter)="updateDespesa(despesa.id, despesa)"
          />
        </div>
        <ng-template #viewCategoria
          >{{ despesa.categoria.descricao }}</ng-template
        >
      </td>
      <td>
        <div *ngIf="despesa.isEditing; else viewFornecedor">
          <input
            type="text"
            [(ngModel)]="despesa.fornecedor"
            (blur)="updateDespesa(despesa.id, despesa)"
            (keyup.enter)="updateDespesa(despesa.id, despesa)"
          />
        </div>
        <ng-template #viewFornecedor>{{ despesa.fornecedor }}</ng-template>
      </td>
      <td>
        <div *ngIf="despesa.isEditing; else viewPreco">
          <input
            type="text"
            [(ngModel)]="despesa.preco"
            (blur)="updateDespesa(despesa.id, despesa)"
            (keyup.enter)="updateDespesa(despesa.id, despesa)"
          />
        </div>
        <ng-template #viewPreco
          >{{ despesa.preco | currency:'BRL' }}</ng-template
        >
      </td>
      <td>
        <div *ngIf="despesa.isEditing; else viewQuantidade">
          <input
            type="text"
            [(ngModel)]="despesa.quantidade"
            (blur)="updateDespesa(despesa.id, despesa)"
            (keyup.enter)="updateDespesa(despesa.id, despesa)"
          />
        </div>
        <ng-template #viewQuantidade>{{ despesa.quantidade }}</ng-template>
      </td>
      <td>{{ despesa.total | currency:'BRL' }}</td>
      <td>{{ despesa.dataCompra }}</td>

      <td>
        <mat-icon (click)="toggleEditDespesa(despesa)">edit</mat-icon>
      </td>
    </tr>
  </tbody>
</table>

<mat-paginator
  #paginator
  class="demo-paginator"
  (page)="mudarPagina($event)"
  [length]="page.totalItens"
  [pageSize]="page.itensPorPagina"
  [pageSizeOptions]="tamanhosDePagina"
  aria-label="Select page"
>
</mat-paginator>

<!-- Tabela de Membros -->
<h2>Membros</h2>
<table>
  <tbody>
    <tr *ngFor="let membro of membros">
      <td>{{ membro.nome }}</td>
    </tr>
  </tbody>
</table>

<!-- Tabela Editável de Categorias -->
<h2>Categorias</h2>
<table class="table-editable">
  <tbody>
    <tr *ngFor="let categoria of categorias">
      <td>
        <div *ngIf="categoria.isEditing">
          <input
            type="text"
            [(ngModel)]="categoria.descricao"
            (keyup.enter)="updateCategoria(categoria.id, categoria)"
            (blur)="updateCategoria(categoria.id, categoria)"
          />
        </div>
        <div *ngIf="!categoria.isEditing">{{ categoria.descricao }}</div>
      </td>
      <td>
        <mat-icon (click)="toggleEdit(categoria)">edit</mat-icon>
      </td>
    </tr>
  </tbody>
</table>
